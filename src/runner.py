from model.model_service import ModelService
import torch
from loguru import logger


def main():
    """
    Main function to run the model service and make predictions.
    """
    logger.info("Starting the model service")
    ml_svc = ModelService()
    ml_svc.load_model()
    test_data = torch.tensor([15, 85, 89, 91, 92, 96, 96, 100, 111, 119, 126,
                              132, 135, 141, 142, 145, 147, 149, 152, 155,
                              158, 160, 161, 163, 165, 167, 167, 168, 169,
                              85, 88, 86, 86, 91, 94, 101, 111, 119, 126,
                              132, 137, 141, 143, 145, 146, 151, 153, 155,
                              158, 160, 162, 165, 167, 169, 168, 169, 169,
                              88, 82, 111, 141, 104, 93, 98, 110, 120, 128,
                              132, 138, 142, 143, 144, 146, 150, 153, 155,
                              159, 161, 162, 165, 167, 169, 167, 169, 170,
                              89, 74, 145, 177, 155, 135, 120, 112, 118, 122,
                              133, 140, 143, 145, 144, 147, 150, 154, 157, 159,
                              163, 164, 165, 166, 168, 168, 171, 171, 87, 81,
                              107, 155, 146, 143, 150, 141, 137, 125, 124, 125,
                              132, 136, 142, 148, 154, 158, 159, 160, 162, 165,
                              165, 167, 169, 169, 171, 173, 86, 89, 84, 105,
                              115, 110, 128, 138, 142, 147, 139, 130, 128, 127,
                              130, 131, 132, 139, 147, 157, 165, 164, 166, 167,
                              170, 171, 172, 174, 86, 87, 90, 91, 94, 97, 109,
                              113, 112, 137, 140, 138, 133, 134, 141, 144, 131,
                              116, 109, 100, 151, 170, 167, 170, 171, 172, 172,
                              174, 86, 88, 91, 93, 93, 96, 104, 109, 104, 117,
                              126, 124, 120, 117, 139, 153, 154, 131, 121, 94,
                              86, 159, 171, 169, 172, 173, 174, 176, 86, 87,
                              89, 92, 93, 95, 105, 115, 120, 125, 125, 125,
                              119, 114, 146, 149, 153, 138, 138, 120, 94, 100,
                              167, 171, 172, 174, 176, 177, 85, 87, 88, 90, 93,
                              95, 105, 114, 119, 129, 137, 139, 132, 148, 162,
                              150, 146, 156, 145, 137, 123, 91, 104, 172, 172,
                              175, 177, 178, 85, 86, 88, 90, 93, 97, 104, 113,
                              127, 129, 132, 140, 148, 172, 165, 127, 145, 159,
                              141, 156, 138, 111, 78, 112, 178, 172, 177, 177,
                              85, 86, 87, 90, 94, 94, 108, 150, 136, 137, 133,
                              124, 153, 152, 127, 109, 133, 154, 134, 167, 146,
                              114, 95, 72, 135, 181, 175, 178, 85, 86, 88, 91,
                              93, 91, 118, 159, 150, 162, 165, 140, 113, 120,
                              98, 68, 124, 137, 134, 167, 147, 118, 99, 84, 78,
                              151, 181, 179, 85, 86, 89, 91, 92, 93, 106, 126,
                              134, 165, 174, 143, 121, 131, 125, 104, 120, 126,
                              141, 147, 140, 119, 102, 87, 80, 81, 159, 183,
                              84, 85, 87, 88, 91, 95, 103, 115, 130, 146, 144,
                              126, 136, 140, 131, 136, 137, 131, 111, 105, 120,
                              111, 99, 84, 83, 71, 95, 173, 84, 85, 85, 86, 89,
                              93, 104, 114, 121, 128, 121, 112, 133, 141, 138,
                              143, 150, 137, 106, 84, 95, 97, 92, 91, 83, 82,
                              72, 107, 83, 85, 85, 86, 88, 92, 103, 113, 119,
                              125, 177, 124, 98, 108, 137, 142, 145, 132, 100,
                              86, 91, 90, 90, 93, 89, 84, 83, 72, 81, 81, 83,
                              87, 87, 91, 102, 113, 120, 123, 187, 147, 93, 46,
                              78, 125, 137, 126, 100, 90, 92, 90, 91, 95, 91,
                              87, 85, 78, 81, 81, 82, 85, 85, 91, 103, 111,
                              120, 123, 173, 140, 83, 65, 57, 73, 121, 101, 89,
                              89, 94, 95, 94, 95, 92, 90, 87, 80, 80, 81, 83,
                              84, 84, 91, 102, 112, 122, 123, 172, 139, 74,
                              103, 73, 70, 103, 114, 97, 95, 99, 101, 98, 94,
                              91, 90, 87, 85, 79, 80, 81, 83, 84, 89, 100,
                              109, 119, 121, 165, 136, 70, 141, 81, 119, 89,
                              123, 119, 112, 105, 98, 96, 92, 88, 87, 86, 87,
                              78, 79, 80, 82, 83, 88, 98, 108, 120, 115, 179,
                              134, 61, 151, 125, 93, 141, 114, 104, 93, 95,
                              92, 91, 91, 90, 91, 90, 87, 77, 77, 75, 78, 77,
                              84, 96, 106, 117, 116, 172, 118, 65, 141, 159,
                              66, 149, 138, 87, 109, 79, 76, 81, 79, 79, 84,
                              87, 90, 120, 115, 114, 117, 116, 119, 120, 123,
                              126, 126, 137, 86, 100, 149, 129, 90, 146, 151,
                              144, 156, 106, 68, 68, 67, 68, 71, 78, 85, 98,
                              97, 98, 100, 104, 102, 100, 98, 94, 94, 96, 85,
                              99, 103, 100, 98, 105, 105, 106, 105, 105, 82,
                              72, 80, 86, 90, 92, 94, 96, 97, 96, 97, 96, 95,
                              96, 95, 90, 93, 95, 99, 98, 95, 97, 98, 96, 96,
                              96, 96, 97, 97, 97, 104, 99, 106, 103, 108, 100,
                              98, 99, 101, 98, 99, 100, 100, 99, 99, 102, 100,
                              99, 102, 104, 101, 100, 100, 102, 102, 103, 104,
                              99, 127, 114, 114, 108, 117, 101, 99, 98, 99, 99,
                              100, 102, 101, 102, 102, 102, 99, 99, 100, 101,
                              101, 101, 101, 100, 100, 101, 104, 95, 127, 143,
                              126, 125, 126], dtype=torch.float32)[1:]
    test_data /= 255.0
    test_data = test_data.view(1, 1, 28, 28)
    pred = ml_svc.predict(test_data)
    logger.info(f"Prediction result: {pred}")


if __name__ == "__main__":
    main()
